---
title: "STAT480 Project Title: College tuition, diversity, and pay"
author: "Vahid Azizi, Seyedzahra Khoshmanesh, and Saba Moeinizade"
date: "4/21/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

**Abstract:**
Many people are interested to know about the tuition, costs, diversity and potential salary when searching for college. In this project, we want to analyze tuition costs across different states, and explore diversity in different schools. The data set includes different variables such as school name, state, type of school, in-state/out-of-state tuition, group/racial/gender category, early/mid-career pay, stem percent and historical tuition information. We are also interested in trends of tuition over time. We will use different summary statistics and visualizations in R to address these problems.



### Getting familaiar with data

```{r, message=FALSE}
address<-c('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/')

tuition_cost <- readr::read_csv(paste(address,'tuition_cost.csv',sep=""))

tuition_income <- readr::read_csv(paste(address,'tuition_income.csv',sep=""))

salary_potential <- readr::read_csv(paste(address,'salary_potential.csv',sep=""))

historical_tuition <- readr::read_csv(paste(address,'historical_tuition.csv',sep=""))

diversity_school <- readr::read_csv(paste(address,'diversity_school.csv',sep=""))
```

```{r}
tuition_cost%>%glimpse()
tuition_income%>%glimpse()
salary_potential%>%glimpse()
historical_tuition%>%glimpse()
diversity_school%>%glimpse()
```


### The relationship between college tuition and campus diversity
#### Zahra

First, we look at the availabe diverse categories captured in schools across the US.

```{r}
diversity_school %>%
  group_by(state,category) %>% 
  mutate(enrollment_rate=round((enrollment/total_enrollment),2)*100) %>% 
  summarise(mean_enrollment_rate_per_state=mean(enrollment_rate)) %>% 
  arrange(desc(mean_enrollment_rate_per_state)) %>% 
    ggplot(aes(x=state,weight=mean_enrollment_rate_per_state,fill=category)) +
  geom_bar()+
  coord_flip()
```

Let us create a new variable which indicates the enrollment rate per each category for each state in the US.

```{r}
diversity_enroll_rate <- diversity_school %>%
  group_by(state,category) %>% 
  mutate(enrollment_rate=round((enrollment/total_enrollment),2)*100) %>% 
  summarise(mean_enrollment_rate_per_state=mean(enrollment_rate))

diversity_enroll_rate %>% glimpse()

```


Now, let us explore any relationship between the enrollment rate and tuition for each diverse category. We merge tuition_cost dataset with diversity dataset.

```{r}
tuition_cost %>% 
  group_by(state) %>% 
  summarise(in_state_tuition=mean(in_state_tuition),
            out_of_state_tuition=mean(out_of_state_tuition)) %>% 
   merge(diversity_enroll_rate) %>% 
   filter(category %in% c("Asian","White","Black","American Indian / Alaska Native")) %>%
  ggplot(aes(x=in_state_tuition,y=mean_enrollment_rate_per_state, color=category)) +
  geom_point()

```

```{r}
#merged<-dplyr::left_join(tuition_cost, diversity_school, by = c("name", "state"))
```

### The historical trend of tuition
#### Saba
```{r}
```

### Cost of college tuition in US by geographic area
#### Vahid
```{r}
head(tuition_cost)
```

```{r}
library(forcats)

tuition_cost %>% group_by(type) %>% summarise(n=n()) %>% ggplot(aes(x=fct_reorder(type,n), y=n,fill=as.factor(type)))+ geom_bar(stat="identity") +labs(y="Number of college ",x="Type")+
  geom_text(aes(label=n), position=position_dodge(width=0.9), vjust=-0.25)+
  theme(legend.position = "none")
```



```{r, fig.width=10,fig.height=8}

tuition_cost[!is.na(tuition_cost$state),] %>% group_by(state) %>% summarise(n=n()) %>% ggplot(aes(x=fct_reorder(state,n), y=n,fill=as.factor(state)))+ geom_bar(position = 'dodge',stat="identity") +labs(y="Number of college ",x="State")+
  geom_text(aes(label=n), position=position_dodge(width=.3),hjust=1, vjust=.4)+
  coord_flip()+
  theme(legend.position = "none")
```



```{r,fig.width=10,fig.height=8}
tuition_cost[!is.na(tuition_cost$state),] %>% group_by(state) %>% ggplot(aes(x=fct_reorder(state,in_state_tuition), y=in_state_tuition,fill=as.factor(state))) +
  geom_boxplot()+
  coord_flip() +
  labs(x="State",y="In state tuition")+
  theme(legend.position = "none")
```

```{r,fig.width=10,fig.height=8}
tuition_cost[!is.na(tuition_cost$state),] %>% group_by(state) %>% ggplot(aes(x=fct_reorder(state,out_of_state_tuition), y=out_of_state_tuition,fill=as.factor(state))) +
  geom_boxplot()+
  coord_flip() +
  labs(x="State",y="Out of state tuition")+
  theme(legend.position = "none")
```


```{r,fig.width=10,fig.height=8}
tuition_cost[!is.na(tuition_cost$state),] %>% mutate(tuition_diff_in_out=out_of_state_tuition-in_state_tuition) %>% group_by(state) %>% ggplot(aes(x=fct_reorder(state,tuition_diff_in_out), y=tuition_diff_in_out,fill=as.factor(state))) +
  geom_boxplot()+
  coord_flip() +
  labs(x="State",y="Difference in/out tution")+
  theme(legend.position = "none") 
```


```{r,fig.width=10,fig.height=8}
tuition_cost[!is.na(tuition_cost$state),] %>% mutate(tuition_diff_in_out=out_of_state_tuition-in_state_tuition) %>% group_by(state) %>%
  summarise(mean_diff=round(mean(tuition_diff_in_out),2)) %>%
  ggplot(aes(x=fct_reorder(state,mean_diff), y=mean_diff,fill=as.factor(state))) +
  geom_bar(stat="identity")+
  geom_text(aes(label=mean_diff), position=position_dodge(width=.3),hjust=1, vjust=.4)+
  coord_flip() +
  labs(x="State",y="Mean difference in/out tution")+
  theme(legend.position = "none") 
```


### Average potential salary in early/mid-career 
#### Saba
```{r}
```


