---
title: "College tuition, diversity, and pay"
author: "Zahra Khoshmanesh, Vahid Aziziz, Saba Moeinizadeh"
date: "4/25/2020"
output:
  slidy_presentation: default
  ioslides_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(lubridate)

options(warn=-1)  #warning off

us <- map_data("state")

address<-c('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/')

tuition_cost <- readr::read_csv(paste(address,'tuition_cost.csv',sep=""))

tuition_income <- readr::read_csv(paste(address,'tuition_income.csv',sep=""))

salary_potential <- readr::read_csv(paste(address,'salary_potential.csv',sep=""))

historical_tuition <- readr::read_csv(paste(address,'historical_tuition.csv',sep=""))

diversity_school <- readr::read_csv(paste(address,'diversity_school.csv',sep=""))
```

## College tuition, diversity, and pay

- Many people are interested to know about the tuition, costs, diversity and potential salary when searching for college. 
- In this project, we want to analyze tuition costs across different states, and explore diversity in different schools. 
- The data set includes different variables such as school name, state, type of school, in-state/out-of-state tuition, group/racial/gender category, early/mid-career pay, stem percent and historical tuition information. 
- We are also interested in trends of tuition over time. We will use different summary statistics and visualizations in R to address these problems.


## Diversity dataset

```{r, echo = TRUE}

diversity_school %>% glimpse()

```

## Finding the most diverse campus per each diversity categories

```{r}
max_per_category <- diversity_school %>% 
  mutate(eroll_rate_category=(enrollment/total_enrollment)*100) %>% 
  group_by(category) %>% 
  summarise(university_name=name[which.max(eroll_rate_category)],
            state=state[which.max(eroll_rate_category)],
            enrollment_rate=eroll_rate_category[which.max(eroll_rate_category)],
            total_enroll=total_enrollment[which.max(eroll_rate_category)],
            category_enroll=enrollment[which.max(eroll_rate_category)])

max_per_category

```

## Finding the most diverse campus per each diversity categories

```{r}
max_per_category %>% 
  ggplot(aes(x=category,y=enrollment_rate,fill=university_name,label=state)) +
  geom_col() +
  geom_text(nudge_y = -12) +
  coord_flip()
```

## Diversity map of the US for each diversity Group


```{r}
white <- diversity_school %>%
  group_by(state,category) %>% 
  mutate(enrollment_rate=round((enrollment/total_enrollment),2)*100) %>% 
  summarise(mean_enrollment_rate=mean(enrollment_rate)) %>% 
  arrange(desc(mean_enrollment_rate))

white_diversity <- white %>% 
  add_rownames("region") %>% 
  mutate(region=tolower(state))

gg <- ggplot()
gg <- gg + geom_map(data=us, map=us,
                    aes(x=long, y=lat, map_id=region),
                    fill="#ffffff", color="#ffffff", size=0.15)
gg <- gg + geom_map(data=white_diversity, map=us,
                    aes(fill=mean_enrollment_rate, map_id=region),
                    color="#ffffff", size=0.15)
gg <- gg + scale_fill_continuous(low='thistle2', high='darkred', 
                                 guide='colorbar')
gg <- gg + labs(x=NULL, y=NULL)
gg <- gg + coord_map("albers", lat0 = 39, lat1 = 45) 
gg <- gg + theme(panel.border = element_blank())
gg <- gg + theme(panel.background = element_blank())
gg <- gg + theme(axis.ticks = element_blank())
gg <- gg + theme(axis.text = element_blank()) + ggtitle("Diversity categories across the US") +facet_wrap(~category)
gg
```

## Women enrollment rate across the US

```{r}
diversity_school %>%
  group_by(state,category) %>% 
  mutate(enrollment_rate=round((enrollment/total_enrollment),2)*100) %>% 
  summarise(mean_enrollment_rate=mean(enrollment_rate)) %>% 
  filter(category %in% c("Women"),state != "NA") %>% 
  arrange(desc(mean_enrollment_rate)) %>% 
  ggplot() +
  geom_bar(aes(x = reorder(state,mean_enrollment_rate), weight = mean_enrollment_rate, fill = state), show.legend = FALSE) +
  facet_grid(category~.) +
  coord_flip() +
  labs(x="", y="")
```


## Relationship between enrollment rate and in state tuition per each diversity group

```{r}
diversity_enroll_rate <- diversity_school %>%
  group_by(state,category) %>% 
  mutate(enrollment_rate=round((enrollment/total_enrollment),2)*100) %>% 
  summarise(mean_enrollment=mean(enrollment_rate))

tuition_cost %>% 
  group_by(state) %>% 
  summarise(in_state_tuition=mean(in_state_tuition),
            out_of_state_tuition=mean(out_of_state_tuition)) %>% 
   merge(diversity_enroll_rate) %>% 
   ggplot(aes(x=in_state_tuition,y=mean_enrollment, color=category)) +
   geom_point() +
  facet_wrap(~category)

```


## Relationship between enrollment rate and out of state tuition per each diversity group

```{r}

tuition_cost %>% 
  group_by(state) %>% 
  summarise(in_state_tuition=mean(in_state_tuition),
            out_of_state_tuition=mean(out_of_state_tuition)) %>% 
   merge(diversity_enroll_rate) %>% 
   ggplot(aes(x=out_of_state_tuition,y=mean_enrollment, color=category)) +
   geom_point() +
  facet_wrap(~category)

```

